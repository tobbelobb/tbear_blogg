
<!DOCTYPE html
  SYSTEM "about:legacy-compat">
<html lang="en">
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
   
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="theme-color" content="#FBE8A6">
      <meta name="author" content="Torbjorn Ludvigsen">
      <meta name="keywords" content="Reprap, blog, development">
      <meta name="description" content="Reprap blog">
      <meta property="og:type" content="website">
      <meta property="og:title" content="Torbjorn Ludvigsen">
      <meta property="og:url" content="https://torbjornludvigsen.com/blog/2021">
      <meta property="og:description" content="Reprap blog">
      <meta property="og:image" content="https://torbjornludvigsen.com/torbjornludvigsen.JPG">
      <meta name="twitter:card" content="summary">
      <meta name="twitter:site" content="@tobbelobb">
      <meta name="twitter:creator" content="@tobbelobb">
      <link rel="preload" href="../../OpenSansRegular.woff" as="font" type="font/woff" crossorigin="anonymous">
      <link rel="stylesheet" href="../../style.css?v=2" type="text/css">
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
      <link rel="apple-touch-icon" sizes="180x180" href="../../apple-touch-icon.png">
      <link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
      <link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
      <link rel="manifest" href="../../site.webmanifest">
      <link rel="mask-icon" href="../../safari-pinned-tab.svg" color="#5bbad5">
      <meta name="msapplication-TileColor" content="#2d89ef"><script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script><title>Torbjorn Ludvigsen|Blog</title>
   </head>
   <body>
      <nav>
         <ul>
            <li><a href="../../">Home</a></li>
            <li><a href="../../blog" class="active">Blog</a></li>
            <li><a href="../../donate">Donate</a></li>
            <li><a href="../../about">About</a></li>
            <li><a href="../../links">Links</a></li>
         </ul>
      </nav>
      <div id="SiteName">
         Reprap Blog 2021
      </div>
      <div id="MainContent">
         <h1 id="hangprinter_project_72">Hangprinter v4</h1>
         <div class="date">9-7-2021</div>
         <figure>
                  <a href="./bilder/DSC_1065.JPG">
                       <img src="./bilder/DSC_1065_liten.JPG" alt="HP4" width="500" height="281">
                     </a>
                  
            <figcaption>The HP4 Prototype 2</figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/DSC_1066.JPG">
                       <img src="./bilder/DSC_1066_liten.JPG" alt="HP4" width="500" height="281">
                     </a>
                  
            <figcaption>HP4 again.</figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/DSC_1067.JPG">
                       <img src="./bilder/DSC_1067_liten.JPG" alt="HP4" width="500" height="281">
                     </a>
                  
            <figcaption>Another image of HP4.</figcaption>
                
         </figure>
         <p>
            - tobben
            
         </p><br><br><br><h1 id="personal_2">Philosophy of Hangprinter</h1>
         <div class="date">24-6-2021</div>
         <h3>The Software</h3>
         <p>
                  People hate Software.<br>
                  Bugs, leaks, errors.<br>
                  Cryptic messages.<br>
                  Work-arounds.<br>
                  Menus, forms, and help-pages.<br>
                
         </p>
         <p>
                  Software says "Ok, doing it".<br>
                  And you wait, you don't know how long.<br>
                  You don't know what it's doing.<br>
                  You <i>need</i> it to work.<br>
                  It sometimes fails. After a while.<br>
                
         </p>
         <p>
                  Like the most under-funded government agency imaginable.<br>
                  Broken windows, rotten apples, full trashcans everywhere.<br>
                  People defend themselves.<br>
                  Against software.<br>
                
         </p>
         <h3>The Plastic</h3>
         <p>
                  People hate plastic.<br>
                  Weak, cheap, poison.<br>
                  Awful smell, cracking sounds, hysterical colors.<br>
                  Short use.<br>
                  Long trash.<br>
                  Buries us, in lifeless artificiality.<br>
                
         </p>
         <p>
                  Whatever disease you get,<br>
                  there's always a chance<br>
                  that plastic,<br>
                  disturbing your hormones<br>
                  triggered it.<br>
                
         </p>
         <p>
                  That's what people feel.<br>
                  Plastic comes from an unknown place, underground.<br>
                  Plastic poison can penetrate your skin.<br>
                  Get into your body.<br>
                  Like the devil.<br>
                
         </p>
         <p>
                  All other materials are natural.<br>
                  Only plastic is not.<br>
                  People defend themselves.<br>
                  Against plastic.<br>
                
         </p>
         <h3>The Robots</h3>
         <p>
                  People abhor most robots.<br>
                  Plastic and software with motors.<br>
                  Commanded by others.<br>
                  In our surroundings.<br>
                
         </p>
         <p>
                  The few robots that people love,<br>
                  are exactly those<br>
                  that they control,<br>
                  themselves.<br>
                
         </p>
         <p>
                  Other robots steal.<br>
                  Grab attention.<br>
                  Grab pictures, writings, and videos.<br>
                  Robots intrude.<br>
                  Take jobs.<br>
                  Take lives.<br>
                
         </p>
         <p>
                  Robots make money.<br>
                  For the already rich.<br>
                
         </p>
         <p>
                  Robots are<br>
                  the ultimate source<br>
                  of faceless power.<br>
                
         </p>
         <h3>The Future</h3>
         <p>
                  A single person<br>
                  with superior robots<br>
                  could subjugate all other humans.<br>
                  All you need is scale.<br>
                  This risk was not in the past,<br>
                  but is in the future.<br>
                
         </p>
         <p>
                  A group of countries<br>
                  or companies<br>
                  or countries and companies<br>
                  with superior robots<br>
                  own the world.<br>
                  That's the present.<br>
                
         </p>
         <p>
                  People must defend themselves.<br>
                  Against robots.<br>
                  And the only way<br>
                  is with robots.<br>
                
         </p>
         <p>
                  The power over yourself,<br>
                  can stay yours in two ways:<br>
                  through kindness of others,<br>
                  who have robots,<br>
                
         </p>
         <p>
                  Or you can have robots yourself.<br>
                
         </p>
         <p>
                  People who hate software<br>
                  who hate plastic<br>
                  who have little money<br>
                  will stumble into non-ownership of robots.<br>
                  Through defending themselves<br>
                  against software and plastic.<br>
                
         </p>
         <p>
                  They must be given ownership,<br>
                  or they will be owned.<br>
                  Or worse:<br>
                  Irrelevant.<br>
                
         </p>
         <p>
                  They need free robots.<br>
                  They need to be handed their free robots.<br>
                  For free.<br>
                  Extremely friendly robots.<br>
                  Easy robots.<br>
                  Entirely under their command robots.<br>
                  But strong and valuable robots.<br>
                
         </p>
         <p>
                  Robots that they will accept.<br>
                  Robots that will eventually defend <i>them</i>.<br>
                
         </p>
         <p>
                  But people hate robots.<br>
                  And receive robots with stiff smiles.<br>
                  Least wanted pair of socks, on Christmas Day.<br>
                  Hangprinter is me, knitting socks.<br>
                
         </p>
         <p>
                  I hate software and plastic.
                  But I need Robots.
                  And also you.
                
         </p>
         <p>
                  Just my kindness,<br>
                  will not be enough to cover all,<br>
                  when robots of power march in.<br>
                
         </p>
         <p>
                  They will call it,<br>
                  "economic realities",<br>
                  and do what they want.<br>
                  They will harm you only by accident.<br>
                  Because they won't notice you at all.<br>
                
         </p>
         <p>
                  But if you have robots.<br>
                  A few for yourselves,<br>
                  that you love.<br>
                  Then you can step aside.<br>
                  Not care about those in power.<br>
                  And be free.<br>
                
         </p>
         <p>
            - tobben
            
         </p><br><br><br><h1 id="hangprinter_project_71">Torbj&oslash;rn Must Test New Things. hp-mark Is Good Enough.</h1>
         <div class="date">13-4-2021</div>
         <p>
                  I saw this
                  <a href="https://www.youtube.com/watch?v=5EuWCFCgy58">talk</a>
                  about one of my favourite artist's creative process.
                  Here are a few quotes from it that I've resoned around the last few days:
                
         </p>
         <p>
                  1: <i>"Publishing is not finishing. All the emotions are different. [...] Publishing is deciding to stop when you want to keep working.
               And it's super painful."</i>
                
         </p>
         <p>
                  2: <i>"Publishing works best if you think of it as a style of working. It's an attitude that persists throughout the entire creative
               process.
                       Working to publish is about getting shit done. Your whole mentality shifts when you're working to publish. You focus
               on the stuff that matters,
                       and you ignore the stuff that doesn't."</i>
                
         </p>
         <p>
                  3: <i>"Working to publish, it's selfless, it's outward focused, it's about results, and giving back, and contributing to the world."</i>
                
         </p>
         <p>
                  His shortest version of the good work to publish method is this:
                
         </p>
         <p>
                  4: <i>"... doing only what matters, the whole time, and then stopping."</i>
                
         </p>
         <p>
                  He explains that this is a great strategy because most ideas and attempts flop, and you don't know which will succeed
            beforehand.
                
         </p>
         <p>
                  5: <i>"You can't choose what you're famous for. ... I can't make a song a hit.
                       I can't control how my songs are pushed through the world and are experienced by others.
                       What I can do is be prolific, I can be creative, I can make great stuff.
                       What I can do is work to publish.
                       You write the next scene, you record the next instrument, you build the next set, you shoot the next tape, you design
               the next synth,
                       and I can </i>[publish all that]<i> and then I can move on, and I can go to sleep at night, knowing that I did everything I could."</i>
                
         </p>
         <p>
                  I want to see if this musician's points can help me think better about where to take hp-mark and Hangprinter from here.
                  His work is different from my work, but we're also similar.
                  Let's see if we can make our experiences fit.
                
         </p>
         <h3>1: Publishing Is Not Finishing</h3>
         <p>
                  Things are never finished, we have that in common.
                  I like his emotion focused description.
                
         </p>
         <p>
                  With where I'm at with hp-mark right now, I don't want to keep working.
                  So we're not exactly at the same spot, the musician and I.
                  That's because hp-mark is not like a song. It's more like an instrument.
                
         </p>
         <p>
                  Since even before starting to build hp-mark, I've thought of it as lifting Open Source Hardware over a threshold,
                  closing the loop, ending the guessing game in open source hardware positioning.
                  A short-term grind, a long-term investment for the common good.
                
         </p>
         <p>
                  Proprietary machines have had motion tracking for decades.
                  Everyone knows an OSHW motion tracker could be made.
                  It just requires someone's work hours.
                  That might as well be me, I thought.
                  But it's not very fun, no, and I knew that.
                  It's painful to continue.
                  It will be delightful to stop.
                
         </p>
         <p>
                  My hp-mark process changes after this month's demo, because hp-mark is good enough.
                  I have improved both code and hardware a lot, and tested it thoroughly over the last month.
                  It can take OSHW over the threshold just fine, if it reaches widely.
                
         </p>
         <figure>
                  <a href="./bilder/Done_apr_2.JPG">
                       <img src="./bilder/Done_apr_2.JPG" alt="Done March/April 2021" width="500" height="281">
                     </a>
                  
            <figcaption>Tasks completed during this sprint.</figcaption>
                
         </figure>
         <h3>2: Working to Publish</h3>
         <p>
                  The musician and I have different outputs and different metrics.
                  For music, success is to reach people.
                  hp-mark needs to
                  
            <ul>
               <li>reach people, and to</li>
               <li>work well enough for them,</li>
            </ul>to be successful.
                  My pain comes from ignoring/failing at the former while working to my bones on the latter.
                
         </p>
         <p>
                  But the musician's point makes a lot of sense for hp-mark in the continuation.
                  Just make a small thing and see if it flies.
                  See if you can have a little success, quickly.
                  I will get back to that way of working.
                
         </p>
         <p>
                  Make something small work well enough, then try to reach people.
                  Make something else work then try to reach people again.
                  And again and again and so on.
                
         </p>
         <p>
                  I regret not pasting a giant Aruco marker on the Hangprinter back in November 2020.
                  I could also have dropped the spherical markers in December, when I found they were hard to make/source.
                  And the colored markers stayed with me for too long also.
                  I would have reached more collaborators and supporters by doing something simple,
                  and then spent time reaching out instead.
                  Imperfect decisions there. Well, well.
                
         </p>
         <h3>3 and 4 are Mostly the Same</h3>
         <p>
                  I think quotes 3 and 4 mostly come down to the
                  same improvement of process for hp-mark as quote 2 did:
                  
            <ol>
                       
               <li>Make a small thing.</li>
                       
               <li>See if it flies.</li>
                     
            </ol>
                
         </p>
         <h3>5: Torbjorn Tests New Things</h3>
         <p>
                  I interpret quote 5 as "test new things, test different things, do the next thing".
                  The last couple of Hangprinter years have felt a bit stagnant.
                  Particularly on the outreach side of things. Why?
                
         </p>
         <p>
                  Many worthwhile Hangprinter related projects are hard and time consuming.
                  Robustness is not quick, easy, cheap, or sensational.
                  We need robustness.
                  So I had to dive into "doing it right", and swam across the swamp.
                
         </p>
         <p>
                  Still, I should have done it more
                  quick, easy, cheap, and sensational than I did.
                
         </p>
         <p>
                  There's always a light version of any project, one that breaks you down less.
                  I must break down less. Economically and motivationally.
                
         </p>
         <p>
                  Quick things to try:
                  
            <ul>
                       
               <li>Hangprinter with a very heavy effector</li>
                       
               <li>Hangprinter with big heat bed</li>
                       
               <li>Hangprinter with capable clay extruder</li>
                       
               <li>Hangprinter with two tool heads mounted</li>
                       
               <li>Hangprinter with as simple as possible tool changer</li>
                       
               <li>hp-mark with a GIANT marker</li>
                       
               <li>Outdoor Hangprinting</li>
                       
               <li>Collaboration with 3d-printing artists</li>
                       
               <li>Scripting auto calibration (easy now, after 7 months of grind :-P)</li>
                       
               <li>Load cells along lines</li>
                       
               <li>Store bought pellet extruder</li>
                     
            </ul>
                  Things that I don't yet know how to fit into the quick publish and outreach success template:
                  
            <ul>
                       
               <li>RepRapFirmware upgrade</li>
                       
               <li>Electronics (Duet Wifi to Duet 3) upgrade</li>
                       
               <li>Even more hp-mark precision and accuracy</li>
                       
               <li>Hangprinter v4 official release with documentation</li>
                       
               <li>More closed line guides, smaller bearings</li>
                     
            </ul>
            
                
         </p>
         <p>
            - tobben
            
         </p><br><br><br><h1 id="hangprinter_project_70">hp-mark Is Good But Lonely</h1>
         <div class="date">27-3-2021</div>
         <p>
                  The rabbit hole has gotten deeper.
                  But progress is fast at this stage.
                  Average error (that's accuracy) has shrunk from ca 35 mm to ca 3.5 mm.
                  Maybe even smaller.
                  I haven't tested accuracy thoroughly yet.
                
         </p>
         <p>
                  Precision (that's stability of repeated measurements) at the origin is down from ca 5 mm to ca 1 mm.
                  And also:
                
         </p>
         <p>
                  CHECK!<input type="checkbox" checked disabled>Detect all markers on 95% of training images<br>
                
         </p>
         <p>
                  The markers have changed from small colored spheres to bigger retro-reflective disks.
                  They're cheaper, lighter, easier to manufacture, and perform much, much better.
                
         </p>
         <p>
                  I had to go and implement the disk geometric equations.
                  My body protested for days when I picked up that task.
                  Luckily, this time I had a
                  <a href="https://link.springer.com/content/pdf/10.1007/978-3-540-24672-5_41.pdf">research paper</a>
                  to guide me through most of the theory,
                  and I could quickly replicate my old test structure.
                  This made me ca 10x faster compared to when I did the sphere geometry.
                
         </p>
         <p>
                  I've posted a couple of demos since last time:
                
         </p>
         <figure>
                  
            <div class="embed-container">
                       <iframe src="https://www.youtube.com/embed/m9qjuZQowCE" frameborder="0" allowfullscreen="true">
                          </iframe>
                     
            </div>
                
         </figure>
         <figure>
                  
            <div class="embed-container">
                       <iframe src="https://www.youtube.com/embed/yRF-zevGHlQ" frameborder="0" allowfullscreen="true">
                          </iframe>
                     
            </div>
                
         </figure>
         <p>
                  The first video shows the more fundamental use case for hp-mark: auto/assisted anchor calibration.
                  It enables all other hp-mark use cases, including homing.
                
         </p>
         <p>
                  So hp-mark is growing up.
                
         </p>
         <p>
                  The extremely high recognition and identification rate I have now is thanks to some LEDs
                  that I put around the camera:
                
         </p>
         <figure>
                  <a href="./bilder/POWERFUL.jpeg">
                       <img src="./bilder/POWERFUL_liten.jpeg" alt="My Picam with led rings around it" width="500" height="253">
                     </a>
                  
            <figcaption>My picam v2 with two rings of in total 20 LEDs around it.
                       This removes most problems I had with shadows disturbing measurements.
                       I'd say it took identification rate from ca 95% to ca 99%(?).
                       Out of ca 1000 test images, I haven't recorded a single identification failure yet.
                     
            </figcaption>
                
         </figure>
         <p>
                  I know I could enhance accuracy and precision further by mounting these slightly higher end, low distortion lenses:
                
         </p>
         <figure>
                  <a href="./bilder/low_distortion_lenses.jpeg">
                       <img src="./bilder/low_distortion_lenses_liten.jpeg" alt="A set of low distortion lenses" width="500" height="281">
                     </a>
                  
            <figcaption>A set of low distortion lenses that I ordered from Arducam.
                       This setup would use the same image sensor, wire connection, and software interface as the current Picam v2.
            </figcaption>
                
         </figure>
         <p>
                  However, changing the camera PCB and lens means having to calibrate it and also make a new mounting bracket for it.
                  Plus all the fiddling with wires, focusing the camera, unexpected stuff etc.
                
         </p>
         <p>
                  My guess is 1-2 days of work.
                  Is it worth it? What are my goals?
                
         </p>
         <h3>Keep Your Head Down And Work!</h3>
         <p>
                  This sprint's goal is "high accuracy auto calibration".
                  The higher level goal is "a reliable work horse".
                  Peace of mind.
                
         </p>
         <p>
                  The better camera achieves all of that.
                  So I have to do it.
                  Just like I redid the markers.
                
         </p>
         <p>
                  This isn't how I worked a few years back.
                  This isn't how the HP1, HP2, HP3, and first prototype of HP4 were made.
                  They were all just barely working systems.
                  This is why HP4 will be different.
                
         </p>
         <h3>AAAAAAA!</h3>
         <p>
                  Body is shouting loudly.
                  And for good reason.
                
         </p>
         <p>
                  Rest of World, aka everyone I meet, care extremely little about hp-mark
                  in its current form.
                  It you're reading this blog post, you're among very few
                  (<a href="https://torbjornludvigsen.goatcounter.com/">source</a>).
                
         </p>
         <p>
                  As much as I crave attention, Rest of World craves brain tickle.
                  Humans need this always.
                  Brains want to light up.
                
         </p>
         <p>
                  Current form hp-mark just isn't very...
                
         </p>
         <figure>
                  <a href="./bilder/darth_vader_helmet.jpg">
                       <img src="./bilder/darth_vader_helmet_liten.jpg" alt="A side shot of Darth Vader's helmet" width="500" height="376">
                     </a>
                  
            <figcaption>MRI scan of person reading up on how a measurement system that is unrelated to their life improved from 35 to 3.5.</figcaption>
                
         </figure>
         <p>
                  ... stimulating.
                  For me, a person who is constantly dying for attention, this is a problem.
                
         </p>
         <h3>What To Do</h3>
         <p>
                  Even at nanometer precision, hp-mark without a context would be nano-stimulating to the non-Hangprinter owning world.
                  Common solutions to this kind of problem:
                  
            <ol>
                       
               <li>Pay folks to suffer thruogh your under-stimulating thing. Attention-as-a-service. Day jobs. Ads. This is the most common solution
                  out in the wild.
               </li>
                       
               <li>Find people who love your stuff by unusual amounts.</li>
                       
               <li>Put your thing into an exciting context/story.</li>
                       
               <li>Pitch! Learn pitching dark arts.</li>
                       
               <li>Accept defeat.</li>
                     
            </ol>
                
         </p>
         <p>
                  All of these have their own pros and cons.
                  Too much to write down here.
                  I will do number 5 for the rest of this sprint, and then try my luck at number 3.
                
         </p>
         <figure style="left-margin:auto">
                  <a href="./bilder/current_sprint2.JPG">
                       <img src="./bilder/current_sprint2_liten.JPG" alt="Tasks of the current sprint" width="338" height="600">
                     </a>
                  
            <figcaption>The sprint in question.</figcaption>
                
         </figure>
         <p>
                  The first slightly more exciting context, at least for hp-mark, will be HP4.
                  End-to-end, released machine, with build manual and all.
                  I look forward to that.
                
         </p>
         <h3>Outlook</h3>
         <p>
                  HP4 is not very interesting on its own either though.
                  It will need it's own number 3 eventually.
                  A context creates a story.
                  Without a story, humans can not understand, or hardly even percieve your stuff.
                
         </p>
         <h3>Number 3 Suggestions for HP4</h3>
         <ul>
                  
            <li>
                       Hangprinting a body shaped house that's later sold as an art piece on a blockchain.
                     
            </li>
                  
            <li>
                       A variable size telescope rod framed Hangprinter on wheels that collects its own raw material and can flip pancakes.
                       Perfect for Burning Man.
                     
            </li>
                  
            <li>
                       Using HP4 as a motorized trampoline for cats. Computer vision detects cat. Ejects/bounces cat. Cat happy. The end.
                     
            </li>
                  
            <li>
                       A Hangprinter v4 built... inside Minecraft. And then being sold as an NFT on a blockchain. Just add the blockchain
               to the end of every suggestion from here on.
                     
            </li>
                  
            <li>
                       A Hangprinter with AI that registers its own company, and prints and assembles an array of other machines to be its
               employees.
                     
            </li>
                  
            <li>
                       A Hangprinter that just connects deeply with people.
                     
            </li>
                  
            <li>
                       Something simpler. A HP that puts cheese on a pizza and the slices it.
                     
            </li>
                  
            <li>
                       Hangprinter doing something oddly satesfying, like cutting paper, or 3d printing ceramic poop. With glazing.
                     
            </li>
                  
            <li>
                       A Hangprinter hanging down from space.
                     
            </li>
                  
            <li>
                       A Hangprinter mounted upside-down. So D-anchor is on floor, ABC-anchors in ceiling, and print surface is in the ceiling.
                       Mounted sideways would also work, for hype purposes, but not very well in practice.
                     
            </li>
                  
            <li>
                       A big Hangprinter outside using a hundred helium balloons as its D-anchor.
                     
            </li>
                  
            <li>
                       A single, fat, vertical, constant speed extrusion. Preferrably made with the HP from space.
                     
            </li>
                  
            <li>
                       Printing a complete working bike in one go.
                     
            </li>
                  
            <li>
                       A flexible motor driven suspended Hang-printbed. A <a href="https://gitlab.com/tobben/hangbed">hangbed</a>.
                     
            </li>
                  
            <li>
                       A HP that's just super huge, with ABC anchors mounted on big trucks, and D on a high crane.
                       This is the most frequently encountered one out in the wild, which more or less guarantees that it's a good one.
                       The word HUUUUGE by itself already tickles a bit. I'm sure you can feel it.
                     
            </li>
                
         </ul>
         <h3>Short End Note</h3>
         <p>
                  The old HP story is basically "a living thing that creates economic value".
                  Fully automated, self-replicating, printing furniture, taking zero space when not in use.
                  I'm not sure if that is tickly enough from my attention cravings' perspective.
                  Before it's even out there we'll never know.
                
         </p>
         <p>
                  hp-mark does more than just exist now.
                  It's getting quite good, but also quite lonely.
                
         </p>
         <p>
            - tobben
            
         </p><br><br><br><h1 id="hangprinter_project_69">hp-mark Exists Now</h1>
         <div class="date">15-2-2021</div>
         <p>
                  I climbed down a rabbit hole recently.
                  Nearly half a year working on hp-mark.
                  The past 84 days even skipping blog post and newsletter writing.
                
         </p>
         <p>
                  Progress has been steady.
                  It works now.
                  <a href="https://gitlab.com/tobben/hp-mark">hp-mark</a> measures positions, like:
                
         </p>
         <figure>
                  <a href="./bilder/result-217_0.png">
                       <img src="./bilder/result-217_0_liten.png" alt="First ever non-zero result from hp-mark" width="500" height="376">
                     </a>
                  
            <figcaption>Result 1: [-1.27, -217.65, 2.68]. Hand measured position is [0, -217, 0].</figcaption>
                
         </figure>
         <p>
                  Accuracy is not fantastic.
                  The image above is a lucky one, with only 3 mm of error.
                  A more commonly seen error is around 35 mm.
                
         </p>
         <p>
                  A lot of hp-mark work remains.
                  I ticked 2 boxes, and added 6 new ones in the
                  <a href="https://gitlab.com/tobben/hp-mark/-/blob/master/README.md#status">roadmap</a>
                  today:
                
         </p>
         <p>
                  <input type="checkbox" checked disabled>Aquire camera 6D pose (this includes defining our world coordinate system)<br>
                  <input type="checkbox" checked disabled>Aquire effector 6D pose<br>
                  <input type="checkbox" disabled>Detect all markers on 95% of training images<br>
                  <input type="checkbox" disabled>Take image ourselves upon request, don't rely on other programs to take image first<br>
                  <input type="checkbox" disabled>Create a continous stream of position measurements (video?)<br>
                  <input type="checkbox" disabled>Get a statistical idea about size of error<br>
                  <input type="checkbox" disabled>Respond to RepRapFirmware/Duet request for position measurement<br>
                  <input type="checkbox" disabled>Integrate a second camera, to reduce error<br>
                
         </p>
         <p>
                  I'm a bit overwhelmed still.
                  I need to look backwards a bit.
                
         </p>
         <h3>What Have I Done?</h3>
         <p>
                  I've been surprised.
                
         </p>
         <figure>
                  
            <video width="500" height="367" controls="controls">
                       
               <source src="bilder/fun.mp4" type="video/mp4"></source>
                        
               <!--source src="movie.ogg" type="video/ogg"-->
                        Your browser does not support the video tag.
                     
            </video>
                  
            <figcaption>
                       Video stitched together from todays test images.
                     
            </figcaption>
                
         </figure>
         <p>
                  I chose C++, OpenCV, and a very traditional approach for this project.
                  I just wanted the most basic code that would mecanically find circles among pixels,
                  and then apply static geometric equations to transform circles into a nozzle position.
                  No AI stuff, no GPU stuff, no fancy hardware control, just
            $$
              f(x) \rightarrow y,
            $$
                 where \(x\) is an image, and \(y\) is a nozzle position.
                
         </p>
         <p>
                  Such an old and explored problem!
                  I felt confident.
                
         </p>
         <p>
                  Some things that took long for me to program, in descending order:
                  
            <ul>
                       
               <li><b>Good enough ellipse detection.</b> OpenCV's <code>SimpleBlobDetector</code> was ok, but ultimately not
                            robust enough for our purposes. I was lucky to find <a href="https://github.com/CihanTopal/ED_Lib">ED_Lib</a>, and spent a little over a month integrating it into hp-mark.
                            For example, I had to fight a little to get sub-pixel accuracy in the center and size data. More about that
                            <a href="https://github.com/CihanTopal/ED_Lib/issues/12">here</a>.
               </li>
                       
               <li><b>Geometry.</b> A photon bounces off a sphere, through a pinhole, and onto an image sensor. Many more follow.
                            They create a pattern, a projection, on the image sensor.
                            Given the position of the sphere, what's the equation of its projection? Or vice versa; given a projection,
                            what's the position of the sphere? Which projected point correspond to the sphere's center? I derived all relevant
                  equations by hand and wrote tests that wouldn't go
                            green before I was exactly right.
                            To bootstrap the chain of testable geometric functions, I derived the most basic equation in two different
                            ways, and tested that the two derived functions gave exactly the same results.
                            The system would never be good if the theory it rested upon wasn't sound, so I spent the time to make this
                            perfect.
               </li>
                       
               <li><b>Filtering among ellipses.</b> The improved ellipse detector found <i>lots</i> of ellipses.
                            Getting hp-mark to determine which ellipses represent real markers, was hard.
                            To  be real useful, hp-mark must be able to identify all its markers almost all the time,
                            so I spent extra time here as well. I will return to this point in the future, but we're at least finding
                            all the markers ca 80% of the time now.
               </li>
                       
               <li><b>Color recognition.</b> The human brain is full of heuristics that helps us determine color,
                            in a wide variety of situations. Very fine details of camera settings, light/shadow,
                            and way of definition, throws a simplistic computer program off very easily.
                            The strongest heuristic I was able to program, in which all colors are relative, still can not
                            identify a non-marker in a set of six real and one false marker.
                            Still, I was able to keep color as a marker categorizer that lets us
                            avoid having to put QR-codes on our markers.
                            I fought a bit for the aesthetics.
                          
               </li>
                     
            </ul>
                
         </p>
         <p>
                  I feel like I'm almost too tired of it to even write about this stuff now.
                  But before I climb out of this rabbit hole,
                  I can show you something about how the ellipse detector works internally:
                
         </p>
         <figure>
                  <a href="./bilder/input3.png">
                       <img src="./bilder/input3.png" alt="Input to ellipse detector" width="500" height="407">
                     </a>
                  
            <figcaption>A zoomed in version of the original image from the PiCam v2.</figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/edgeImage3.png">
                       <img src="./bilder/edgeImage3.png" alt="edge image inside ellipse detector" width="500" height="407">
                     </a>
                  
            <figcaption>Color contrast between pixels were used to find these edges in the image.</figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/segmentImage3.png">
                       <img src="./bilder/segmentImage3.png" alt="segment image inside ellipse detector" width="500" height="407">
                     </a>
                  
            <figcaption>The edge pixels are the grouped into segments. Each segment has a different color in this visualization.
                       A single segment that forms a closed circle or ellipse will be detected already at this stage.
                       Most detectors can find complete closed-curve ellipses quickly and easily.
                       What sets ED_Lib apart is how hard it tries to piece together the chopped-up circles, and how quick and cheap
                       it manages to do this.
                     
            </figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/lines1Image3.png">
                       <img src="./bilder/lines1Image3.png" alt="lines image inside ellipse detector" width="500" height="407">
                     </a>
                  
            <figcaption>The segments are split up further into lines and arcs. These are the lines.</figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/edarcs1Image3.png">
                       <img src="./bilder/edarcs1Image3.png" alt="arcs image inside ellipse detector" width="500" height="407">
                     </a>
                  
            <figcaption>... and these are the arcs.
                       (If you compare very closely with the segments image, you find that not all arcs match exactly.
                       They should match exactly.
                       I mixed up images from two different runs when preparing this, so this arc visualization is ever so slightly off.
                       It's still representative for the result below though, in that the top blue marker could not be found amog these arcs
               either, but all other markers were found.)
                     
            </figcaption>
                
         </figure>
         <figure>
                  <a href="./bilder/edCircles3.png">
                       <img src="./bilder/edCircles3.png" alt="output of ellipse detector" width="500" height="407">
                     </a>
                  
            <figcaption>The arcs are combined into circles and ellipses according to many different heuristics.</figcaption>
                
         </figure>
         <p>
                  In the image above, we see that one marker was missed, despise ED_Lib's many different heuristics.
                  I tried to tune the heuristics for the hp-mark use case.
                  See how that went, <a href="https://github.com/CihanTopal/ED_Lib/issues/13">here</a>.
                
         </p>
         <p>
                  Ultimately failing to tune the heuristics convinced me to put background plates below my markers.
                  That is what I'm currently working on.
                  They will probably end up looking something like this:
                
         </p>
         <figure>
                  <a href="./bilder/octagon.jpeg">
                       <img src="./bilder/octagon_liten.jpeg" alt="marker with bent octagonal background" width="500" height="500">
                     </a>
                  
            <figcaption>Test of marker background with bent octagonal background.</figcaption>
                
         </figure>
         <p>
                  The final background design will probably be flat and circular, and hp-mark will use the edge of the
                  background, as well as the marker itself, to determine its position, further improving both robustness and accuracy
            of the system.
                
         </p>
         <p>
                  But not today.
                  I'm so tired of that kind of programming.
                  Let's celebrate the restuls at the top of this post for a while first.
                  And let's rest.
                
         </p>
         <p>
            - tobben
            
         </p><br><br><br><br><br><br><br><br><br><br><br><h1 id="Links">
            Links
            
         </h1>
         <p>
            Hangprinter Campaign: <a href="https://salt.bountysource.com/teams/hangprinter">Bountysource Salt</a></p>
         <p>
            Hangprinter Merchandise USA: <a href="https://shop.spreadshirt.com/hangprinter-merchandise/">Spreadshirt.com</a></p>
         <p>
            Hangprinter Merchandise Sweden: <a href="https://shop.spreadshirt.se/hangprinter-merchandise/">Spreadshirt.se</a></p>
         <p>
            Hangprinter Project: <a href="../2014#Hangprinter">[1]</a>,
            <a href="../2015#Slideprinter_Update">[2]</a>,
            <a href="../2015#hangprinter_project_2">[3]</a>,
            <a href="../2015#hangprinter_project_3">[4]</a>,
            <a href="../2015#hangprinter_project_4">[5]</a>,
            <a href="../2015#hangprinter_project_5">[6]</a>,
            <a href="../2015#hangprinter_project_6">[7]</a>,
            <a href="../2015#hangprinter_project_7">[8]</a>,
            <a href="../2015#hangprinter_project_8">[9]</a>,
            <a href="../2015#hangprinter_project_9">[10]</a>,
            <a href="../2015#hangprinter_project_10">[11]</a>,
            <a href="../2015#hangprinter_project_11">[12]</a>,
            <a href="../2015#hangprinter_project_12">[13]</a>,
            <a href="../2015#hangprinter_project_13">[14]</a>,
            <a href="../2015#hangprinter_project_14">[15]</a>,
            <a href="../2015#hangprinter_project_15">[16]</a>,
            <a href="../2015#hangprinter_project_16">[17]</a>,
            <a href="../2015#hangprinter_project_17">[18]</a>,
            <a href="../2015#hangprinter_project_18">[19]</a>,
            <a href="../2016#hangprinter_project_19">[20]</a>,
            <a href="../2016#hangprinter_project_20">[21]</a>,
            <a href="../2016#hangprinter_project_21">[22]</a>,
            <a href="../2016#hangprinter_project_22">[23]</a>,
            <a href="../2016#hangprinter_project_23">[24]</a>,
            <a href="../2016#hangprinter_project_24">[25]</a>,
            <a href="../2016#hangprinter_project_25">[26]</a>,
            <a href="../2016#hangprinter_project_26">[27]</a>,
            <a href="../2016#hangprinter_project_27">[28]</a>,
            <a href="../2017#hangprinter_project_28">[29]</a>,
            <a href="../2017#hangprinter_project_29">[30]</a>,
            <a href="../2017#hangprinter_project_30">[31]</a>,
            <a href="../2017#hangprinter_project_31">[32]</a>,
            <a href="../2017#hangprinter_project_32">[33]</a>,
            <a href="../2017#hangprinter_project_33">[34]</a>,
            <a href="../2017#hangprinter_project_34">[35]</a>,
            <a href="../2017#hangprinter_project_35">[36]</a>,
            <a href="../2017#hangprinter_project_36">[37]</a>,
            <a href="../2017#hangprinter_project_37">[38]</a>,
            <a href="../2017#hangprinter_project_38">[39]</a>,
            <a href="../2017#hangprinter_project_39">[40]</a>,
            <a href="../2017#hangprinter_project_40">[41]</a>,
            <a href="../2017#hangprinter_project_41">[42]</a>,
            <a href="../2017#hangprinter_project_42">[43]</a>,
            <a href="../2017#hangprinter_project_43">[44]</a>,
            <a href="../2017#hangprinter_project_44">[45]</a>,
            <a href="../2017#hangprinter_project_45">[46]</a>,
            <a href="../2017#hangprinter_project_46">[47]</a>,
            <a href="../2017#hangprinter_project_47">[48]</a>,
            <a href="../2017#hangprinter_project_48">[49]</a>,
            <a href="../2017#hangprinter_project_49">[50]</a>,
            <a href="../2017#hangprinter_project_50">[51]</a>,
            <a href="../2018#hangprinter_project_51">[52]</a>,
            <a href="../2018#hangprinter_project_52">[53]</a>,
            <a href="../2018#hangprinter_project_53">[54]</a>,
            <a href="../2018#hangprinter_project_54">[55]</a>,
            <a href="../2018#hangprinter_project_55">[56]</a>,
            <a href="../2018#hangprinter_project_56">[57]</a>,
            <a href="../2018#hangprinter_project_57">[58]</a>,
            <a href="../2018#hangprinter_project_58">[59]</a>,
            <a href="../2018#hangprinter_project_59">[60]</a>,
            <a href="../2018#hangprinter_project_60">[61]</a>,
            <a href="../2018#hangprinter_project_61">[62]</a>,
            <a href="../2018#hangprinter_project_62">[63]</a>,
            <a href="../2020#hangprinter_project_63">[64]</a>,
            <a href="../2020#hangprinter_project_64">[65]</a>,
            <a href="../2020#hangprinter_project_65">[66]</a>,
            <a href="../2020#hangprinter_project_66">[67]</a>,
            <a href="../2020#hangprinter_project_67">[68]</a>,
            <a href="../2020#hangprinter_project_68">[69]</a>,
            <a href="../2021#hangprinter_project_69">[70]</a></p>
         <p>
            Hangprinter Project Homepage: <a href="https://hangprinter.org">hangprinter.org</a></p>
         <p>
            Print Issue Solution Filter Project: <a href="../2014#Introducing_PISF">[1]</a>,
            <a href="../2014#Presenting_PISF_Again">[2]</a>,
            <a href="../2014#PISF_Online_Sort_Of">[3]</a>,
            <a href="../2014#PISF">[4]</a></p>
         <p>
            Sourcing RepRappro Mendel in Larvik: <a href="../2014#Sourcing_Mendel_1">[1]</a>,
            <a href="../2014#Sourcing_Mendel_2">[2]</a>,
            <a href="../2014#Sourcing_Mendel_3">[3]</a>,
            <a href="../2014#Sourcing_Mendel_4">[4]</a>,
            <a href="../2014#Sourcing_Mendel_5">[5]</a>,
            <a href="../2014#Sourcing_Mendel_6">[6]</a>,
            <a href="../2014#Sourcing_Mendel_7">[7]</a></p>
         <p>
            Archive: <a href="../2014">2014</a>, <a href="../2015">2015</a>, <a href="../2016">2016</a>, <a href="../2017">2017</a>, <a href="../2018">2018</a>, <a href="../2020">2020</a>, <a href="../2021">2021</a></p>
         <p>
            Github Profile: <a href="https://github.com/tobbelobb/">link</a><br></p>
         <p>
            Gitlab Profile: <a href="https://gitlab.com/tobben">link</a><br></p>
         <p>
            Hangprinter project on Gitlab: <a href="https://gitlab.com/hangprinter">link</a><br></p>
         <p>
            Vimeo User: <a href="https://vimeo.com/user23166500">link</a><br></p>
         <p>
            Youtube User: <a href="https://www.youtube.com/channel/UCw1Nz0VCw4z-dfq4WjSkFzQ">link</a><br></p>
         <p>
            Twitter User: <a href="https://twitter.com/tobbelobb">link</a><br></p>
         <p>
            Master's Thesis: <a href="http://opensourceecology.org/wiki/File:Thesis.pdf">link</a><br></p>
         <p>
            Linkedin Profile: <a href="https://se.linkedin.com/in/torbjorn-ludvigsen">link</a><br></p>
         <p>
            Appropedia User: <a href="http://www.appropedia.org/User:Tobben">link</a><br></p>
         <p>
            RepRap Forums User: <a href="http://forums.reprap.org/profile.php?1,22385">link</a></p>
         <p>
            Forums threads: <a href="http://forums.reprap.org/read.php?178,344022">Hangprinter version 1</a>,
            <a href="http://forums.reprap.org/read.php?1,738858">Hangprinter version 2</a>,
            <a href="http://forums.reprap.org/read.php?1,792937">Hangprinter version 3</a>,
            <a href="https://reprap.org/forum/list.php?423">List of Hangprinter threads</a></p>
         <p>
            Source for this blog: <a href="https://gitlab.com/tobben/tbear_blogg">Gitlab repo</a></p>
         <p>
            Everything on this homepage, except those videos who are published via Vimeo or Youtube, is licenced under the <a href="https://www.gnu.org/licenses/fdl">Gnu Free Documentation Licence</a>.
            The videos published via Vimeo or Youtube are also licenced via Vimeo or Youtube.
            
         </p>
      </div><br><br><br><br><br><br><br><br><script type="text/javascript">
  MathJax.Hub.Configured()
</script><script data-goatcounter="https://torbjornludvigsen.goatcounter.com/count" async="true" src="//gc.zgo.at/count.js"></script></body>
</html>